<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


	<mapper namespace="reply">
	
  	<insert id="insertReply">
  		insert into reply (bno, replytext, replyer, secretreply) 
  		values (#{bno}, #{replytext}, #{replyer}, #{secretreply})
  	</insert>
  	
  	<select id="replyList" resultType="com.reply.dto.ReplyVO">
  		SELECT rno, bno, replytext, replyer, r.regdate. r.updatedate, secretReply, m.user_name,
  		(SELECT writer FROM memberboard WHERE bno = e.bno) AS writer
  		FROM rely r LEFT JOIN user m on r.replyer = m.user_id
  		WHERE r.replyer = m.user_id AND bno=#{bno}
  		ORDER BY rno
  		<!--  <include refid = "pagingFooter"/> -->
  	</select>
  	
  	<select id="detailReply" resultType="com.reply.dto.ReplyVO">
  		SELECT rno, bno, replytext, replyer, regdate, updatedate, secretReply FROM product_Reply
  		WHERE rno = #{rno}
  	</select>
  	
  	<select id="updateReply">
  		UPDATE product_Reply
  		SET replytext = #{rno}
  		WHERE rno = #{rno}
  	</select>
  	  	
  	<delete id="deleteReply">
  		DELETE FROM product_Reply
  		WHERE rno = #{rno}
  	</delete>

	<select id="countReply" resultType="int">
  		SELECT COUNT(*) FROM reply
  		WHERE bno = #{bno}
  	</select>

	<sql id="pagingFooter">
  		LIMIT 10 OFFSET #{start}
  	</sql>
  	
  </mapper>