<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="order">
<insert id="insert">
		INSERT INTO setOrder (order_num, order_seq_num, product_id, product_name, product_price, order_con, product_desc, product_opt, 
		product_thumnail, user_idx, user_id, user_email, user_phone, user_address1, user_address2, user_address3, postcode, order_message, total_amount)
		VALUES (#{order_num}, order_seq_num.nextval, #{product_id}, #{product_name}, 
		#{product_price}, #{order_con}, #{product_desc}, #{product_opt}, #{product_thumnail}, #{user_idx}, #{user_id}, 
		#{user_email}, #{user_phone}, #{user_address1}, #{user_address2}, #{user_address3}, #{postcode}, #{order_message}, #{total_amount})
		
		<selectKey resultType="integer" keyProperty="order_seq_num" order="BEFORE">
			SELECT order_seq_num.nextval FROM dual
		</selectKey>
	</insert>
	
	<select id="countOrderId" resultType="integer">
		SELECT NVL2(MAX(orderId), MAX(orderId)+1, 1) FROM setOrder
	</select>
</mapper>